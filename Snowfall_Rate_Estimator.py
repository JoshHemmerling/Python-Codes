import pandas as pd
from io import StringIO

def read_sounding_data(text_data):
    lines = text_data.strip().split("\n")
    header_line = lines[0]
    data_lines = lines[1:]
    data_cleaned = "\n".join([",".join(line.strip().split()) for line in [header_line] + data_lines])
    df = pd.read_csv(StringIO(data_cleaned))
    return df

def find_dgz(df):
    # Get the layer between -12Â°C and -18Â°C
    dgz_layer = df[(df['TEMP'] <= -12) & (df['TEMP'] >= -17)]

    if dgz_layer.empty or len(dgz_layer) < 2:
        print("âš ï¸ DGZ layer not well defined â€” snowfall rate may be inaccurate.")
        return 0, None, None

    dgz_depth = dgz_layer['HGHT'].max() - dgz_layer['HGHT'].min()
    avg_rh = dgz_layer['RELH'].mean() / 100  # Convert to fraction
    return dgz_depth / 1000, avg_rh, dgz_layer  # return in km

#Input Cape value in from direct location on Pivotal Weather
#Calculate average Omega by Dividing OPRH by Mean RH * Mean PW
def estimate_snowfall_rate(dgz_depth_km, avg_rh, omega=None, cape=None):
    # Ask for missing values
    if omega is None:
        try:
            omega = float(input("Enter estimated upward motion (omega) in m/s (e.g., 0.03): "))
        except:
            omega = 0.03
            print("Using default omega = 0.03 m/s")
    if cape is None:
        try:
            cape = float(input("Enter CAPE (Convective Available Potential Energy) in J/kg (e.g., 50): "))
        except:
            cape = 50
            print("Using default CAPE = 50 J/kg")

    # Simple estimate: snow_rate = 0.1 * DGZ depth * RH * omega factor
    # Adding cape factor just to scale convective intensity if relevant
    snow_rate = 1 * dgz_depth_km * avg_rh * (omega * 10) * (1 + cape / 500)
    
    return round(snow_rate, 2)

# === Main usage ===
#Input Raw Sounding Data from Wyoming Weather Lab; Delete text underneath and paste new data in
# If not working, you deleted the ""
sounding_text = """
PRES   HGHT   TEMP   DWPT   RELH   MIXR   DRCT   SPED   THTA   THTE   THTV
 1000.0    189                                                               
  996.4    218    2.0   -1.8     76   3.36     77    3.1  275.4  284.8  276.0
  995.4    226    2.1   -1.6     76   3.40     78    2.7  275.6  285.1  276.2
  994.7    232    1.8   -1.8     77   3.36     80    2.8  275.4  284.7  276.0
  994.1    237    1.7   -1.9     77   3.33     81    3.0  275.3  284.6  275.9
  993.6    241    1.7   -2.0     77   3.32     82    3.2  275.3  284.5  275.9
  993.1    245    1.6   -2.2     76   3.28     83    3.5  275.3  284.4  275.8
  992.5    250    1.6   -2.3     75   3.25     84    3.8  275.3  284.3  275.8
  991.8    256    1.5   -2.4     75   3.23     85    4.0  275.3  284.3  275.8
  990.9    263    1.5   -2.4     75   3.23     86    4.3  275.3  284.3  275.9
  990.1    269    1.4   -2.5     75   3.22     86    4.5  275.4  284.3  275.9
  989.5    275    1.4   -2.5     75   3.21     87    4.7  275.4  284.3  275.9
  989.1    278    1.3   -2.6     75   3.20     88    4.9  275.4  284.3  275.9
  988.8    280    1.3   -2.6     75   3.20     88    5.0  275.4  284.3  275.9
  988.6    282    1.3   -2.6     75   3.18     89    5.2  275.3  284.2  275.9
  988.2    285    1.3   -2.7     75   3.17     89    5.3  275.3  284.2  275.9
  987.7    289    1.2   -2.7     75   3.17     90    5.5  275.3  284.2  275.9
  987.1    294    1.2   -2.8     75   3.16     91    5.6  275.3  284.1  275.9
  986.5    299    1.1   -2.8     75   3.14     91    5.6  275.3  284.1  275.9
  985.9    304    1.1   -2.9     74   3.12     92    5.7  275.4  284.1  275.9
  985.1    310    1.1   -3.1     74   3.09     93    5.8  275.4  284.1  276.0
  984.3    317    1.2   -3.2     73   3.07     93    5.8  275.6  284.1  276.1
  983.6    323    1.2   -3.3     72   3.05     94    5.8  275.6  284.1  276.1
  983.0    328    1.2   -3.3     72   3.04     95    5.8  275.7  284.2  276.2
  982.4    332    1.2   -3.4     71   3.02     95    5.8  275.7  284.1  276.2
  981.8    337    1.2   -3.6     70   2.98     96    5.8  275.7  284.1  276.2
  981.1    343    1.3   -3.8     69   2.95     97    5.8  275.9  284.2  276.4
  980.3    349    1.4   -3.9     68   2.93     98    5.8  276.1  284.3  276.6
  979.6    355    1.4   -4.0     68   2.91     99    5.8  276.1  284.3  276.6
  979.0    360    1.3   -4.0     67   2.89    100    5.8  276.2  284.3  276.6
  978.4    365    1.3   -4.0     68   2.90    101    5.7  276.2  284.3  276.6
  978.0    369    1.3   -4.0     68   2.92    102    5.7  276.1  284.3  276.6
  977.6    372    1.2   -4.0     68   2.91    104    5.7  276.1  284.3  276.6
  977.3    374    1.2   -4.1     68   2.90    105    5.7  276.1  284.3  276.6
  976.9    377    1.2   -4.1     68   2.88    106    5.7  276.1  284.2  276.6
  976.4    382    1.1   -4.1     68   2.88    108    5.7  276.2  284.3  276.7
  975.6    388    1.3   -4.1     68   2.90    109    5.8  276.4  284.5  276.8
  974.8    395    1.5   -4.1     67   2.89    110    5.8  276.6  284.8  277.1
  973.9    402    1.5   -4.2     66   2.87    112    5.8  276.7  284.8  277.2
  973.2    408    1.5   -4.4     65   2.83    113    5.9  276.8  284.8  277.2
  972.7    413    1.5   -4.5     64   2.81    114    6.0  276.8  284.7  277.3
  972.2    416    1.5   -4.6     64   2.79    115    6.0  276.8  284.7  277.3
  971.9    419    1.4   -4.6     64   2.79    116    6.1  276.8  284.7  277.3
  971.5    422    1.4   -4.7     64   2.77    117    6.2  276.9  284.7  277.3
  971.2    425    1.4   -4.8     64   2.76    118    6.3  276.9  284.7  277.3
  970.7    429    1.4   -4.8     63   2.76    119    6.4  276.9  284.6  277.3
  970.2    433    1.4   -4.9     63   2.74    120    6.5  276.9  284.6  277.3
  969.6    438    1.3   -5.0     63   2.73    120    6.6  276.9  284.6  277.4
  969.0    443    1.3   -5.0     63   2.72    121    6.8  276.9  284.6  277.4
  968.4    448    1.3   -5.0     63   2.71    121    6.9  276.9  284.6  277.4
  967.9    452    1.2   -5.1     63   2.70    122    7.0  276.9  284.6  277.4
  967.4    456    1.2   -5.1     63   2.70    122    7.1  276.9  284.6  277.4
  966.9    460    1.1   -5.1     63   2.71    122    7.2  276.9  284.6  277.4
  966.4    464    1.1   -5.1     64   2.71    122    7.3  276.9  284.6  277.4
  966.0    468    1.0   -5.1     64   2.71    122    7.4  276.9  284.6  277.4
  965.4    473    1.0   -5.1     63   2.70    122    7.4  277.0  284.6  277.4
  964.7    478    1.0   -5.2     63   2.70    122    7.5  277.0  284.6  277.4
  964.1    483    1.0   -5.2     63   2.70    122    7.6  277.0  284.6  277.5
  963.6    488    0.9   -5.2     64   2.69    122    7.7  277.0  284.6  277.4
  963.2    491    0.9   -5.2     64   2.70    122    7.7  277.0  284.6  277.4
  962.7    496    0.8   -5.2     64   2.70    122    7.8  277.0  284.6  277.4
  962.1    500    0.8   -5.2     64   2.70    121    7.8  277.0  284.6  277.4
  961.5    505    0.7   -5.2     64   2.69    121    7.9  276.9  284.6  277.4
  960.8    512    0.7   -5.3     64   2.69    121    7.9  277.0  284.6  277.4
  960.0    518    0.7   -5.3     64   2.68    120    7.9  277.0  284.6  277.5
  959.2    524    0.6   -5.3     64   2.68    120    7.9  277.0  284.6  277.5
  958.6    529    0.5   -5.3     65   2.68    120    8.0  277.0  284.5  277.4
  958.1    534    0.4   -5.3     66   2.68    119    8.0  276.9  284.5  277.3
  957.6    538    0.3   -5.3     66   2.68    119    8.0  276.9  284.5  277.3
  957.2    542    0.3   -5.3     66   2.69    119    8.0  276.9  284.5  277.3
  956.7    546    0.3   -5.3     66   2.68    118    8.0  276.9  284.5  277.3
  956.2    550    0.2   -5.4     66   2.68    118    8.0  276.9  284.4  277.3
  955.6    554    0.2   -5.4     66   2.67    118    8.0  276.9  284.4  277.3
  955.1    559    0.2   -5.4     66   2.67    118    8.0  276.9  284.5  277.4
  954.6    563    0.1   -5.5     66   2.66    118    8.0  276.9  284.5  277.4
  954.1    567    0.0   -5.6     66   2.63    118    8.0  276.9  284.3  277.3
  953.6    571   -0.1   -5.9     65   2.58    118    8.0  276.8  284.1  277.2
  953.2    575   -0.1   -6.0     64   2.56    118    8.0  276.8  284.1  277.2
  952.6    580   -0.1   -6.0     64   2.55    118    7.9  276.8  284.1  277.2
  952.0    585   -0.2   -6.0     65   2.56    118    7.9  276.8  284.1  277.3
  951.3    591   -0.2   -5.9     66   2.59    119    7.9  276.9  284.2  277.3
  950.8    595   -0.2   -5.8     66   2.61    119    7.9  276.9  284.3  277.3
  950.4    598   -0.3   -5.8     66   2.61    120    7.9  276.9  284.3  277.3
  950.1    601   -0.3   -5.8     67   2.61    120    7.9  276.9  284.3  277.3
  949.7    604   -0.3   -5.7     67   2.62    120    7.9  276.9  284.3  277.3
  949.2    609   -0.4   -5.7     67   2.63    121    7.9  276.9  284.3  277.3
  948.5    614   -0.4   -5.7     67   2.63    122    7.8  276.9  284.3  277.3
  947.9    620   -0.5   -5.8     67   2.62    122    7.8  276.9  284.3  277.3
  947.4    624   -0.5   -5.9     67   2.61    123    7.8  276.9  284.2  277.3
  947.0    627   -0.6   -5.8     68   2.61    123    7.8  276.8  284.2  277.3
  946.6    631   -0.6   -5.8     68   2.63    124    7.8  276.8  284.3  277.3
  946.1    635   -0.6   -5.7     68   2.63    125    7.9  276.8  284.3  277.3
  945.6    639   -0.7   -5.8     68   2.62    125    7.9  276.9  284.3  277.3
  945.0    644   -0.7   -5.9     68   2.60    126    7.9  276.9  284.2  277.3
  944.4    649   -0.8   -6.0     68   2.58    126    7.9  276.8  284.2  277.3
  943.9    653   -0.8   -6.1     68   2.58    127    7.9  276.8  284.2  277.3
  943.5    657   -0.9   -6.1     68   2.57    127    7.9  276.8  284.1  277.3
  943.1    660   -0.9   -6.1     68   2.56    127    7.9  276.8  284.1  277.2
  942.7    664   -1.0   -6.1     68   2.57    128    8.0  276.8  284.1  277.2
  942.2    667   -1.0   -6.1     69   2.58    128    8.0  276.8  284.1  277.2
  941.8    671   -1.1   -6.1     69   2.58    128    8.0  276.8  284.1  277.2
  941.4    675   -1.1   -6.1     69   2.58    128    8.0  276.8  284.1  277.2
  940.9    679   -1.1   -6.1     69   2.58    128    8.0  276.8  284.1  277.2
  940.4    683   -1.2   -6.1     69   2.58    128    8.0  276.8  284.1  277.2
  939.9    687   -1.2   -6.1     69   2.58    128    8.0  276.8  284.1  277.2
  939.4    692   -1.3   -6.1     70   2.58    127    8.0  276.8  284.1  277.2
  938.8    696   -1.3   -6.1     70   2.58    127    7.9  276.8  284.1  277.2
  938.3    701   -1.3   -6.1     70   2.58    127    7.9  276.8  284.1  277.2
  937.7    706   -1.4   -6.1     70   2.58    126    7.9  276.8  284.1  277.3
  937.2    710   -1.4   -6.2     70   2.57    126    7.9  276.8  284.1  277.2
  936.6    715   -1.5   -6.2     70   2.56    125    7.8  276.8  284.1  277.3
  936.0    720   -1.5   -6.2     70   2.57    125    7.8  276.8  284.1  277.3
  935.5    725   -1.5   -6.2     71   2.58    124    7.8  276.8  284.2  277.3
  935.0    729   -1.6   -6.1     71   2.58    124    7.8  276.8  284.2  277.3
  934.6    732   -1.6   -6.2     71   2.58    123    7.7  276.8  284.1  277.3
  934.2    736   -1.6   -6.2     71   2.57    123    7.7  276.8  284.1  277.3
  933.7    740   -1.7   -6.2     71   2.57    122    7.7  276.8  284.1  277.3
  933.2    744   -1.7   -6.2     71   2.57    121    7.6  276.8  284.1  277.3
  932.6    749   -1.8   -6.2     71   2.57    121    7.6  276.9  284.1  277.3
  932.1    754   -1.8   -6.3     72   2.57    120    7.6  276.9  284.2  277.3
  931.6    758   -1.8   -6.3     72   2.57    120    7.6  276.9  284.2  277.3
  931.0    763   -1.8   -6.3     72   2.57    119    7.6  276.9  284.2  277.3
  930.4    768   -1.9   -6.3     72   2.57    119    7.6  276.9  284.2  277.3
  929.8    773   -1.9   -6.3     72   2.57    118    7.6  276.9  284.2  277.3
  929.3    778   -2.0   -6.3     73   2.57    118    7.6  276.9  284.2  277.3
  928.7    783   -2.0   -6.3     73   2.57    117    7.6  276.9  284.2  277.3
  928.1    788   -2.1   -6.3     73   2.58    117    7.6  276.9  284.2  277.4
  927.6    792   -2.1   -6.2     73   2.59    117    7.6  276.9  284.3  277.4
  927.2    795   -2.2   -6.2     74   2.59    117    7.7  276.9  284.3  277.3
  926.9    798   -2.2   -6.2     74   2.59    117    7.7  276.9  284.2  277.3
  926.4    802   -2.2   -6.2     74   2.59    117    7.8  276.9  284.2  277.3
  925.9    806   -2.3   -6.2     74   2.59    117    7.8  276.9  284.2  277.3
  925.4    811   -2.3   -6.2     74   2.59    117    7.8  276.9  284.2  277.3
  925.0    814   -2.4   -6.3     74   2.58    117    7.8  276.9  284.2  277.3
  924.9    815   -2.4   -6.3     74   2.58    117    7.9  276.9  284.2  277.3
  924.4    819   -2.4   -6.3     75   2.58    117    7.9  276.9  284.2  277.3
  923.9    824   -2.4   -6.2     75   2.59    117    8.0  276.9  284.3  277.3
  923.4    828   -2.5   -6.2     75   2.60    118    8.0  276.9  284.3  277.4
  922.8    833   -2.5   -6.2     75   2.60    118    8.1  276.9  284.3  277.4
  922.2    839   -2.5   -6.3     76   2.59    118    8.1  276.9  284.3  277.4
  921.5    844   -2.6   -6.3     75   2.58    119    8.2  276.9  284.3  277.4
  920.9    849   -2.6   -6.5     75   2.55    119    8.2  277.0  284.2  277.4
  920.3    855   -2.7   -6.6     74   2.53    120    8.3  277.0  284.1  277.4
  919.8    859   -2.7   -6.7     74   2.52    120    8.3  277.0  284.1  277.4
  919.2    864   -2.8   -6.7     75   2.52    120    8.4  277.0  284.1  277.4
  918.7    868   -2.8   -6.6     75   2.53    121    8.4  277.0  284.2  277.4
  918.2    873   -2.9   -6.6     75   2.54    121    8.5  277.0  284.2  277.4
  917.6    878   -2.9   -6.6     76   2.54    121    8.5  277.0  284.2  277.4
  917.1    883   -2.9   -6.5     76   2.56    121    8.5  277.0  284.2  277.4
  916.5    888   -2.9   -6.4     77   2.58    121    8.5  277.0  284.4  277.5
  915.9    893   -3.0   -6.4     77   2.59    121    8.6  277.1  284.4  277.5
  915.3    898   -3.0   -6.4     77   2.58    121    8.6  277.1  284.4  277.5
  914.7    903   -3.1   -6.5     77   2.57    121    8.6  277.1  284.3  277.5
  914.1    908   -3.1   -6.5     77   2.57    121    8.6  277.0  284.3  277.5
  913.4    914   -3.2   -6.5     78   2.58    121    8.6  277.1  284.4  277.5
  912.8    920   -3.2   -6.4     79   2.60    121    8.6  277.1  284.4  277.5
  912.2    925   -3.2   -6.4     79   2.60    121    8.6  277.1  284.5  277.5
  911.6    930   -3.3   -6.4     79   2.59    121    8.6  277.1  284.5  277.6
  911.0    936   -3.3   -6.5     79   2.59    120    8.6  277.1  284.5  277.6
  910.5    940   -3.3   -6.5     79   2.58    120    8.6  277.1  284.5  277.6
  910.2    942   -3.4   -6.5     79   2.58    120    8.6  277.1  284.5  277.6
  909.9    944   -3.4   -6.5     79   2.58    120    8.6  277.1  284.4  277.6
  909.6    948   -3.4   -6.5     79   2.58    119    8.5  277.1  284.4  277.5
  909.1    952   -3.5   -6.6     79   2.57    119    8.5  277.1  284.4  277.5
  908.6    956   -3.6   -6.6     79   2.56    119    8.4  277.1  284.3  277.5
  908.1    961   -3.6   -6.7     79   2.55    119    8.4  277.1  284.3  277.5
  907.6    965   -3.6   -6.8     79   2.54    119    8.3  277.1  284.3  277.5
  907.1    969   -3.7   -6.8     79   2.53    118    8.2  277.1  284.3  277.5
  906.6    973   -3.7   -6.9     79   2.52    118    8.2  277.1  284.3  277.5
  906.2    977   -3.7   -6.9     78   2.52    118    8.1  277.1  284.3  277.6
  905.7    982   -3.7   -6.9     79   2.52    118    8.0  277.2  284.3  277.6
  905.1    986   -3.7   -6.9     79   2.52    118    7.9  277.2  284.4  277.6
  904.6    991   -3.8   -6.9     79   2.52    119    7.8  277.2  284.4  277.7
  903.9    997   -3.7   -6.9     79   2.53    119    7.7  277.3  284.5  277.7
  903.3   1003   -3.8   -6.9     79   2.53    119    7.7  277.3  284.5  277.8
  902.6   1008   -3.8   -6.8     79   2.54    119    7.6  277.4  284.6  277.8
  902.0   1013   -3.8   -6.8     80   2.55    119    7.5  277.4  284.7  277.8
  901.5   1018   -3.8   -6.8     80   2.56    119    7.4  277.5  284.8  277.9
  900.9   1023   -3.8   -6.8     79   2.54    119    7.3  277.5  284.7  277.9
  900.4   1027   -3.8   -6.9     80   2.54    119    7.2  277.5  284.7  277.9
  899.9   1032   -3.8   -6.8     80   2.56    119    7.1  277.6  284.8  278.0
  899.4   1036   -3.8   -6.7     80   2.58    119    7.0  277.6  285.0  278.1
  898.9   1041   -3.8   -6.6     80   2.59    119    7.0  277.7  285.1  278.2
  898.4   1045   -3.8   -6.6     80   2.59    119    6.9  277.8  285.1  278.2
  897.9   1050   -3.8   -6.6     80   2.59    119    6.8  277.8  285.2  278.3
  897.4   1054   -3.8   -6.6     81   2.60    118    6.7  277.9  285.3  278.3
  896.9   1059   -3.7   -6.5     81   2.62    118    6.7  277.9  285.4  278.4
  896.2   1064   -3.6   -6.3     82   2.66    118    6.6  278.1  285.6  278.5
  895.5   1071   -3.6   -6.3     82   2.66    117    6.5  278.1  285.7  278.6
  894.8   1077   -3.7   -6.3     82   2.66    117    6.4  278.2  285.7  278.6
  894.1   1083   -3.7   -6.4     82   2.66    116    6.3  278.2  285.8  278.6
  893.5   1088   -3.8   -6.3     82   2.66    116    6.2  278.2  285.8  278.6
  893.1   1092   -3.8   -6.3     83   2.68    115    6.1  278.2  285.9  278.7
  892.6   1096   -3.8   -6.2     83   2.70    115    6.0  278.3  285.9  278.7
  892.2   1100   -3.8   -6.1     83   2.71    115    5.9  278.3  286.0  278.8
  891.7   1105   -3.7   -6.1     83   2.71    114    5.8  278.4  286.1  278.8
  891.1   1109   -3.8   -6.2     83   2.71    114    5.7  278.4  286.1  278.9
  890.6   1114   -3.8   -6.2     83   2.70    114    5.6  278.4  286.1  278.9
  890.0   1120   -3.8   -6.2     84   2.70    114    5.4  278.4  286.1  278.9
  889.4   1125   -3.9   -6.3     84   2.69    114    5.3  278.4  286.1  278.9
  888.8   1130   -4.0   -6.3     84   2.69    115    5.2  278.4  286.0  278.8
  888.3   1134   -4.0   -6.3     84   2.69    115    5.1  278.4  286.1  278.9
  887.8   1139   -4.0   -6.2     84   2.70    116    4.9  278.4  286.1  278.9
  887.3   1143   -4.0   -6.2     85   2.71    117    4.8  278.5  286.2  278.9
  886.8   1148   -4.1   -6.3     85   2.69    118    4.7  278.5  286.1  278.9
  886.2   1153   -4.1   -6.3     85   2.69    120    4.6  278.4  286.1  278.9
  885.6   1158   -4.2   -6.3     85   2.70    121    4.5  278.4  286.1  278.9
  885.0   1164   -4.2   -6.3     86   2.71    123    4.4  278.5  286.2  278.9
  884.5   1169   -4.2   -6.2     86   2.71    125    4.4  278.5  286.2  279.0
  883.9   1174   -4.3   -6.2     86   2.72    128    4.3  278.5  286.3  279.0
  883.3   1179   -4.2   -6.1     87   2.74    130    4.3  278.6  286.4  279.1
  882.7   1185   -4.2   -6.1     87   2.75    132    4.3  278.7  286.5  279.2
  882.0   1191   -4.2   -6.1     87   2.75    134    4.4  278.7  286.6  279.2
  881.3   1197   -4.2   -6.0     87   2.76    136    4.4  278.8  286.7  279.3
  880.5   1204   -4.3   -6.0     88   2.78    138    4.5  278.8  286.8  279.3
  879.8   1211   -4.2   -5.9     88   2.79    140    4.6  278.9  286.9  279.4
  879.0   1217   -4.2   -5.9     88   2.79    141    4.7  279.0  287.0  279.5
  878.4   1223   -4.1   -5.8     88   2.82    143    4.8  279.2  287.2  279.7
  877.7   1229   -4.0   -5.8     88   2.84    144    4.9  279.3  287.4  279.8
  877.1   1234   -4.0   -5.8     88   2.84    145    5.0  279.4  287.5  279.9
  876.5   1240   -4.0   -5.8     88   2.83    146    5.1  279.4  287.5  279.9
  875.8   1246   -4.1   -5.8     88   2.83    147    5.2  279.5  287.6  280.0
  875.1   1252   -4.1   -5.8     88   2.83    147    5.4  279.5  287.6  280.0
  874.5   1258   -4.2   -5.8     88   2.83    148    5.5  279.5  287.6  280.0
  873.8   1264   -4.2   -5.9     88   2.82    148    5.6  279.5  287.6  280.0
  873.3   1269   -4.2   -5.9     88   2.82    148    5.7  279.5  287.6  280.0
  872.8   1274   -4.3   -5.9     88   2.82    149    5.8  279.5  287.6  280.0
  872.2   1279   -4.3   -5.9     89   2.82    149    5.8  279.5  287.6  280.0
  871.7   1284   -4.4   -6.0     89   2.81    149    5.9  279.5  287.6  280.0
  871.0   1289   -4.4   -6.0     89   2.81    149    6.0  279.6  287.6  280.0
  870.4   1295   -4.4   -6.0     89   2.81    150    6.0  279.6  287.6  280.1
  869.8   1300   -4.5   -6.0     89   2.80    150    6.1  279.6  287.6  280.1
  869.3   1305   -4.5   -6.1     89   2.80    150    6.1  279.6  287.6  280.1
  868.7   1310   -4.6   -6.1     89   2.80    150    6.1  279.6  287.6  280.1
  868.2   1315   -4.6   -6.1     89   2.80    150    6.1  279.6  287.6  280.1
  867.5   1321   -4.7   -6.1     90   2.79    150    6.1  279.6  287.6  280.1
  866.8   1328   -4.7   -6.1     90   2.79    151    6.1  279.6  287.6  280.1
  866.1   1334   -4.7   -6.2     90   2.79    151    6.1  279.7  287.6  280.1
  865.4   1340   -4.8   -6.2     90   2.78    151    6.0  279.7  287.6  280.1
  864.8   1346   -4.8   -6.3     89   2.76    151    6.0  279.7  287.6  280.1
  864.2   1351   -4.9   -6.3     89   2.75    151    6.0  279.7  287.6  280.2
  863.6   1357   -4.9   -6.3     90   2.77    151    5.9  279.7  287.7  280.2
  862.9   1363   -4.9   -6.3     90   2.78    151    5.9  279.8  287.7  280.3
  862.2   1369   -4.9   -6.3     90   2.77    151    5.8  279.8  287.7  280.3
  861.5   1376   -4.9   -6.4     90   2.75    152    5.8  279.9  287.7  280.3
  860.9   1382   -5.0   -6.4     90   2.75    152    5.7  279.9  287.8  280.4
  860.2   1388   -5.0   -6.4     90   2.75    152    5.7  279.9  287.8  280.4
  859.6   1394   -5.1   -6.5     90   2.74    152    5.6  279.9  287.8  280.4
  859.0   1399   -5.1   -6.5     90   2.73    152    5.6  279.9  287.8  280.4
  858.5   1404   -5.1   -6.5     90   2.74    152    5.5  280.0  287.8  280.4
  857.9   1409   -5.2   -6.5     90   2.74    152    5.5  280.0  287.8  280.5
  857.3   1414   -5.2   -6.5     90   2.74    152    5.4  280.0  287.9  280.5
  856.8   1419   -5.2   -6.5     90   2.74    152    5.4  280.0  287.9  280.5
  856.3   1424   -5.2   -6.5     91   2.74    152    5.3  280.1  287.9  280.5
  855.8   1428   -5.3   -6.6     91   2.74    152    5.3  280.1  287.9  280.5
  855.4   1432   -5.3   -6.6     91   2.73    152    5.3  280.1  287.9  280.5
  854.9   1436   -5.3   -6.6     91   2.73    153    5.3  280.1  287.9  280.5
  854.4   1441   -5.4   -6.6     91   2.73    153    5.3  280.1  287.9  280.6
  853.8   1447   -5.4   -6.6     91   2.73    154    5.3  280.1  287.9  280.6
  853.2   1452   -5.4   -6.6     91   2.73    154    5.4  280.1  288.0  280.6
  852.6   1458   -5.5   -6.7     91   2.72    155    5.4  280.1  287.9  280.6
  852.0   1463   -5.5   -6.7     92   2.72    156    5.5  280.1  287.9  280.6
  851.3   1469   -5.6   -6.7     92   2.71    156    5.6  280.1  287.9  280.6
  850.7   1475   -5.7   -6.7     92   2.71    157    5.7  280.1  287.9  280.6
  850.0   1481   -5.7   -6.8     92   2.71    159    5.9  280.1  287.9  280.6
  849.4   1487   -5.8   -6.8     92   2.70    159    5.9  280.2  287.9  280.6
  848.9   1492   -5.8   -6.8     92   2.70    160    6.0  280.2  287.9  280.6
  848.4   1496   -5.8   -6.9     92   2.70    160    6.1  280.2  287.9  280.6
  848.0   1500   -5.9   -6.9     93   2.69    161    6.3  280.2  287.9  280.6
  847.5   1504   -5.9   -6.9     93   2.69    162    6.5  280.2  287.9  280.6
  847.1   1508   -5.9   -6.9     93   2.69    162    6.6  280.2  287.9  280.6
  846.6   1513   -6.0   -6.9     93   2.69    163    6.8  280.2  287.9  280.6
  846.0   1519   -6.0   -6.9     93   2.69    163    6.9  280.2  287.9  280.7
  845.2   1526   -6.0   -6.9     93   2.69    164    7.1  280.2  288.0  280.7
  844.5   1532   -6.1   -6.9     93   2.69    164    7.3  280.3  288.0  280.8
  843.9   1538   -6.1   -6.9     94   2.70    165    7.4  280.4  288.1  280.8
  843.4   1543   -6.1   -6.9     94   2.70    165    7.6  280.4  288.1  280.8
  842.8   1548   -6.2   -7.0     94   2.69    165    7.7  280.4  288.1  280.8
  842.0   1555   -6.2   -7.0     94   2.69    165    7.8  280.4  288.1  280.9
  841.2   1563   -6.2   -7.0     94   2.69    165    7.9  280.4  288.2  280.9
  840.4   1570   -6.2   -6.9     94   2.71    166    8.0  280.5  288.3  281.0
  839.8   1576   -6.2   -6.9     94   2.71    166    8.1  280.6  288.4  281.1
  839.3   1580   -6.2   -6.9     94   2.71    166    8.2  280.6  288.4  281.1
  838.9   1584   -6.3   -7.0     95   2.71    166    8.3  280.6  288.4  281.1
  838.5   1588   -6.3   -7.0     95   2.70    166    8.3  280.6  288.4  281.1
  837.9   1594   -6.3   -7.0     95   2.69    166    8.4  280.6  288.4  281.1
  837.1   1601   -6.4   -7.0     95   2.70    166    8.4  280.7  288.4  281.1
  836.4   1608   -6.4   -7.1     95   2.69    166    8.4  280.7  288.5  281.2
  835.7   1614   -6.4   -7.1     95   2.69    167    8.4  280.8  288.5  281.2
  835.2   1619   -6.4   -7.1     95   2.69    167    8.4  280.8  288.5  281.2
  834.7   1624   -6.5   -7.1     95   2.69    167    8.4  280.8  288.5  281.2
  834.2   1628   -6.5   -7.1     95   2.68    167    8.4  280.8  288.5  281.3
  833.7   1633   -6.6   -7.2     95   2.67    167    8.3  280.8  288.5  281.3
  833.2   1638   -6.6   -7.3     95   2.66    167    8.3  280.8  288.5  281.3
  832.7   1642   -6.6   -7.2     95   2.67    168    8.3  280.8  288.5  281.3
  832.1   1648   -6.6   -7.2     96   2.67    168    8.3  280.9  288.6  281.3
  831.5   1654   -6.7   -7.3     96   2.67    168    8.3  280.9  288.6  281.3
  830.8   1660   -6.7   -7.3     95   2.65    169    8.2  280.9  288.6  281.4
  830.1   1667   -6.8   -7.4     95   2.64    169    8.2  280.9  288.5  281.4
  829.4   1674   -6.8   -7.4     95   2.64    170    8.2  281.0  288.6  281.4
  828.7   1680   -6.8   -7.4     96   2.65    170    8.2  281.0  288.7  281.5
  828.0   1687   -6.9   -7.4     96   2.66    170    8.3  281.0  288.7  281.5
  827.5   1692   -6.9   -7.4     96   2.65    171    8.3  281.0  288.7  281.5
  827.0   1696   -7.0   -7.5     96   2.63    171    8.3  281.0  288.6  281.5
  826.6   1700   -7.0   -7.5     96   2.63    172    8.3  281.1  288.7  281.5
  826.0   1705   -6.9   -7.5     96   2.63    172    8.4  281.1  288.7  281.6
  825.4   1711   -6.9   -7.5     96   2.64    173    8.4  281.2  288.8  281.7
  824.7   1718   -7.0   -7.5     96   2.64    173    8.5  281.3  288.9  281.7
  824.2   1723   -7.0   -7.5     96   2.64    174    8.6  281.3  288.9  281.7
  823.8   1726   -7.0   -7.5     96   2.64    174    8.6  281.3  288.9  281.8
  823.6   1728   -7.0   -7.5     96   2.65    175    8.7  281.3  289.0  281.8
  823.2   1732   -7.0   -7.4     96   2.66    176    8.8  281.4  289.1  281.8
  822.8   1736   -7.0   -7.4     96   2.66    176    8.9  281.4  289.1  281.9
  822.2   1741   -7.0   -7.4     97   2.66    177    9.0  281.5  289.2  281.9
  821.8   1746   -7.0   -7.4     97   2.66    177    9.0  281.5  289.2  281.9
  821.3   1750   -7.1   -7.5     97   2.66    178    9.1  281.5  289.2  281.9
  820.9   1754   -7.1   -7.5     97   2.65    178    9.2  281.5  289.1  281.9
  820.4   1758   -7.1   -7.5     97   2.65    179    9.3  281.5  289.2  282.0
  819.9   1764   -7.1   -7.6     97   2.64    179    9.4  281.5  289.2  282.0
  819.2   1770   -7.2   -7.6     97   2.64    180    9.4  281.6  289.2  282.0
  818.5   1777   -7.2   -7.6     97   2.64    181    9.5  281.6  289.3  282.1
  817.8   1783   -7.1   -7.7     96   2.63    181    9.6  281.7  289.3  282.2
  817.2   1789   -7.1   -7.7     96   2.63    182    9.6  281.8  289.4  282.3
  816.8   1793   -7.1   -7.7     96   2.63    183    9.7  281.8  289.5  282.3
  816.4   1797   -7.1   -7.6     96   2.64    183    9.7  281.9  289.5  282.3
  816.1   1800   -7.2   -7.6     96   2.64    184    9.8  281.9  289.5  282.3
  815.6   1804   -7.2   -7.6     97   2.64    185    9.8  281.9  289.6  282.4
  815.1   1809   -7.2   -7.6     97   2.65    186    9.8  282.0  289.6  282.4
  814.5   1815   -7.2   -7.6     97   2.66    186    9.9  282.0  289.7  282.5
  813.9   1821   -7.1   -7.6     97   2.66    187    9.9  282.1  289.8  282.6
  813.3   1826   -7.1   -7.6     97   2.66    188    9.9  282.2  289.9  282.7
  812.8   1831   -7.1   -7.5     97   2.67    189    9.9  282.3  290.0  282.7
  812.3   1836   -7.1   -7.5     97   2.68    190    9.9  282.3  290.1  282.8
  811.8   1841   -7.1   -7.5     97   2.68    191    9.9  282.3  290.1  282.8
  811.3   1845   -7.1   -7.5     97   2.68    192    9.9  282.4  290.2  282.9
  810.8   1850   -7.1   -7.5     97   2.68    192    9.9  282.4  290.2  282.9
  810.3   1855   -7.1   -7.5     97   2.69    193    9.8  282.5  290.3  282.9
  809.7   1861   -7.1   -7.5     98   2.70    194    9.8  282.5  290.4  283.0
  809.1   1867   -7.1   -7.4     98   2.72    195    9.8  282.7  290.5  283.1
  808.4   1873   -7.0   -7.3     98   2.73    196    9.8  282.8  290.7  283.2
  807.9   1879   -7.0   -7.4     97   2.72    197    9.7  282.8  290.7  283.3
  807.3   1884   -7.0   -7.5     97   2.71    198    9.7  282.9  290.8  283.4
  806.8   1889   -7.0   -7.4     97   2.71    199    9.7  283.0  290.8  283.4
  806.3   1894   -7.0   -7.5     97   2.71    200    9.7  283.0  290.9  283.5
  805.7   1900   -7.1   -7.5     96   2.69    201    9.6  283.0  290.9  283.5
  805.0   1906   -7.1   -7.6     96   2.68    202    9.6  283.1  290.9  283.5
  804.3   1913   -7.1   -7.7     96   2.67    203    9.6  283.1  290.9  283.6
  803.7   1919   -7.1   -7.7     96   2.66    204    9.5  283.1  290.9  283.6
  803.1   1925   -7.1   -7.8     95   2.66    205    9.5  283.2  290.9  283.7
  802.6   1929   -7.0   -7.7     95   2.68    206    9.4  283.4  291.1  283.8
  802.3   1933   -7.0   -7.6     95   2.70    207    9.4  283.5  291.3  283.9
  802.0   1935   -7.0   -7.6     95   2.70    207    9.4  283.5  291.4  284.0
  801.8   1938   -6.9   -7.5     95   2.71    208    9.3  283.5  291.4  284.0
  801.4   1941   -6.9   -7.5     95   2.71    209    9.3  283.6  291.5  284.1
  800.9   1946   -6.9   -7.4     96   2.73    210    9.2  283.7  291.7  284.2
  800.4   1951   -6.8   -7.3     96   2.76    211    9.2  283.9  291.9  284.4
  799.8   1957   -6.7   -7.3     96   2.77    211    9.1  284.0  292.0  284.5
  799.3   1962   -6.8   -7.3     96   2.76    212    9.0  284.0  292.0  284.5
  798.8   1967   -6.8   -7.4     96   2.75    213    9.0  284.0  292.0  284.5
  798.2   1972   -6.8   -7.4     96   2.75    213    8.9  284.0  292.0  284.5
  797.7   1978   -6.8   -7.4     96   2.76    214    8.8  284.1  292.1  284.6
  797.1   1984   -6.7   -7.3     96   2.78    214    8.8  284.3  292.4  284.7
  796.5   1989   -6.6   -7.2     96   2.81    215    8.7  284.5  292.6  284.9
  795.9   1995   -6.5   -7.1     96   2.82    215    8.6  284.6  292.8  285.1
  795.3   2001   -6.5   -7.1     95   2.82    216    8.6  284.7  292.9  285.1
  794.7   2007   -6.5   -7.1     95   2.82    216    8.5  284.7  293.0  285.2
  794.1   2013   -6.5   -7.2     95   2.81    216    8.4  284.8  293.0  285.3
  793.8   2016   -6.5   -7.2     95   2.81    217    8.3  284.8  293.0  285.3
  793.6   2018   -6.5   -7.1     95   2.82    217    8.2  284.8  293.1  285.3
  793.5   2019   -6.5   -7.1     95   2.82    217    8.1  284.8  293.1  285.3
  793.2   2022   -6.6   -7.2     95   2.81    217    8.1  284.8  293.0  285.3
  792.7   2027   -6.6   -7.2     95   2.80    217    8.0  284.9  293.0  285.3
  792.1   2032   -6.6   -7.3     95   2.80    218    7.9  284.9  293.1  285.4
  791.6   2037   -6.6   -7.3     95   2.80    218    7.8  285.0  293.2  285.5
  791.1   2042   -6.5   -7.3     94   2.80    218    7.7  285.1  293.2  285.5
  790.6   2048   -6.6   -7.4     94   2.78    218    7.7  285.1  293.3  285.6
  789.9   2055   -6.6   -7.4     94   2.77    218    7.6  285.2  293.3  285.6
  789.1   2062   -6.6   -7.4     94   2.77    218    7.5  285.2  293.3  285.7
  788.4   2069   -6.6   -7.5     94   2.77    218    7.5  285.2  293.3  285.7
  788.0   2073   -6.7   -7.5     94   2.77    218    7.4  285.2  293.3  285.7
  787.9   2074   -6.7   -7.5     94   2.76    218    7.3  285.2  293.3  285.7
  787.7   2076   -6.8   -7.5     94   2.76    218    7.3  285.2  293.2  285.6
  787.3   2080   -6.8   -7.5     95   2.76    218    7.3  285.2  293.2  285.6
  786.8   2085   -6.9   -7.6     95   2.75    218    7.2  285.2  293.2  285.6
  786.2   2091   -6.9   -7.6     95   2.74    218    7.2  285.2  293.2  285.7
  785.6   2097   -6.9   -7.7     94   2.73    218    7.1  285.2  293.2  285.7
  784.9   2104   -7.0   -7.7     94   2.73    218    7.1  285.2  293.2  285.7
  784.3   2110   -7.0   -7.7     95   2.73    218    7.1  285.3  293.3  285.7
  783.8   2115   -7.1   -7.8     95   2.72    218    7.0  285.3  293.3  285.7
  783.2   2120   -7.1   -7.8     95   2.71    218    7.0  285.3  293.3  285.8
  782.8   2125   -7.1   -7.8     95   2.71    218    7.0  285.3  293.3  285.8
  782.3   2130   -7.1   -7.8     95   2.72    219    7.0  285.3  293.3  285.8
  781.9   2134   -7.2   -7.9     95   2.71    219    6.9  285.3  293.3  285.8
  781.4   2139   -7.2   -7.9     94   2.69    219    6.9  285.4  293.3  285.8
  780.9   2144   -7.2   -8.0     94   2.68    219    6.9  285.4  293.3  285.8
  780.3   2150   -7.3   -8.0     94   2.68    219    6.8  285.4  293.3  285.9
  779.8   2155   -7.3   -8.1     94   2.67    219    6.8  285.4  293.3  285.9
  779.3   2160   -7.3   -8.2     94   2.65    220    6.8  285.4  293.2  285.9
  778.9   2164   -7.4   -8.2     94   2.65    220    6.8  285.4  293.2  285.9
  778.6   2167   -7.4   -8.2     94   2.64    220    6.7  285.4  293.2  285.9
  778.4   2169   -7.4   -8.3     94   2.64    220    6.7  285.4  293.2  285.9
  777.9   2174   -7.4   -8.2     94   2.64    220    6.7  285.5  293.2  285.9
  777.1   2182   -7.4   -8.2     94   2.66    221    6.7  285.6  293.4  286.0
  776.2   2191   -7.5   -8.2     95   2.66    221    6.6  285.6  293.5  286.1
  775.4   2199   -7.5   -8.2     94   2.66    221    6.6  285.7  293.5  286.2
  774.7   2206   -7.5   -8.2     94   2.65    221    6.6  285.8  293.6  286.2
  774.3   2210   -7.4   -8.2     94   2.65    221    6.5  285.8  293.7  286.3
  774.0   2213   -7.4   -8.2     94   2.66    221    6.5  285.9  293.7  286.3
  773.9   2214   -7.4   -8.2     94   2.66    222    6.5  285.9  293.7  286.4
  773.8   2215   -7.4   -8.2     94   2.66    222    6.5  285.9  293.8  286.4
  773.5   2218   -7.4   -8.2     94   2.66    222    6.5  286.0  293.8  286.4
  773.0   2223   -7.4   -8.2     94   2.67    222    6.5  286.0  293.9  286.5
  772.5   2228   -7.4   -8.2     94   2.68    222    6.5  286.1  294.0  286.6
  772.0   2233   -7.3   -8.1     94   2.68    222    6.5  286.2  294.1  286.7
"""

df = read_sounding_data(sounding_text)
dgz_depth_km, avg_rh, dgz_layer = find_dgz(df)

if dgz_depth_km > 0:
    snow_rate = estimate_snowfall_rate(dgz_depth_km, avg_rh)
    print(f"ğŸŒ¨ï¸ Estimated snowfall rate: {snow_rate} inches per hour")
else:
    print("â„ï¸ Not enough support in DGZ for reliable snowfall rate estimate.")